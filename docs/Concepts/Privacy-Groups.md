---
description: Privacy Groups
---


When operating on [Orion](../HowTo/Configure/Tessera.md#Orion-Mode) mode, Tessera supports operations related to privacy groups such as managing privacy group data and handling transactions that are intended for a privacy group.

There are two types of Privacy Groups:

1) 'Legacy'
2) 'Pantheon' 

Each privacy group is identified by a unique privacyGroupId, generated by hashing the list of members (and a random seed (for 'pantheon' type).

Private transactions are also stored with a privacy group id, if the transaction is intended for a privacy group (whether pantheon or legacy type - see the difference below).

## Legacy Privacy Group

  When [transactions are sent](https://consensys.github.io/tessera/#operation/encryptStoreAndSendJson) to a list of recipients using `privateFor` Tessera creates a Legacy Privacy group. It returns the Legacy privacy group on the `/receive` response back. The legacy privacy group is created only using list of recipient keys and it is unique to that list i.e., you cannot have more than one 'legacy' privacy group for list of recipients.

An example of a legacy group created:

   ```
   {
      "description": "Privacy groups to support the creation of groups by privateFor",
      "members": [
          "98FhPni7u6YspDGcOLl/LgQQwwGPGY4ddm3hmogsqF8=",
          "dzkrEhkHZ/IjHEaQ6teVTU/kMjiwXTI6Ooljcb56w1M="
      ],
      "name": "legacy",
      "privacyGroupId": "jufzisK63xbXDciV0FW1uAi3vXFDNNJpf/M3lUhMiU0=",
      "type": "LEGACY"
   }
   ```

  The legacy privacy group id is created only using a list of recipient keys without adding any random seed therefore is unique to that list i.e., you cannot have more than one 'legacy' privacy group for a given list of recipients.

!!! note

    It is important that in Besu & Tessera, when generating legacy privacy groups from the same list of recipients will result in the same id.

## Pantheon Privacy Group

  Tessera supports API method to create 'Pantheon' Privacy Group. Upon creation the privacy group is distributed to all members ahead of transaction processing. Other methods to delete, retrieve and find privacy group is common to both privacy group types. Please refer [API reference](https://consensys.github.io/doc.tessera/) for more details on these methods.

  When [transactions are sent](https://consensys.github.io/tessera/#operation/encryptStoreAndSendJson) to a privacy group, the transaction payload is distributed to all the members of the privacy group. The main difference to 'Legacy' privacy group is that a random seed is added when generating privacy group id; therefore there could be more than one 'Pantheon' privacy group for the same list of recipients.


!!! note

    Both Privacy group types created off-chain are non-editable ie., adding a new recipient to a privacy group means creating a new privacy group including the recipient.

## Privacy Group - Database Storage

A new table called PRIVACY_GROUP is added to Tessera database to store Privacy Group data.

DDLs will be provided along with release notes to create new privacy group tables.

!!! example 

      CREATE TABLE PRIVACY_GROUP(ID LONGVARBINARY NOT NULL, LOOKUP_ID LONGVARBINARY NOT NULL, DATA LONGVARBINARY NOT NULL, TIMESTAMP BIGINT, PRIMARY KEY (ID));

Privacy group data - before being persisted into the database will be encoded using BinaryEncoder (same mechanism that Tessera used to encode its EncodedPayload data)

## Privacy Group - API Versioning

With the introduction of privacy groups, a transaction being distributed can be associated with a privacy group id. A Tessera node that is running an old version will not be able to understand privacy group id and this can cause inconsistency of data being persisted on different nodes.

Therefore, Tessera's supported api version is incremented to “3.0”, and this will be shared across the network during partyinfo exchange. 

!!! important

    The API version is incremented with the introduction of privacy groups and Tessera will include the privacy group in the encoded payload in `/push` to only those recipients supporting correct version, else the transaction is failed with PrivacyGroupNotSupportedException

These Privacy groups are currently supported for Hyperledger Besu client which maintains a [private state per privacy group](https://besu.hyperledger.org/en/stable/Concepts/Privacy/Privacy-Groups/).

