---
description: Privacy Groups
---


When running in [Orion](../HowTo/Configure/Tessera.md#orion-mode) mode, Tessera supports operations related to privacy groups such as managing privacy group data and handling transactions that are intended for a privacy group.

Two types of privacy group:

1. `legacy`
2. `pantheon`

A unique `privacyGroupId` is used to identify individual privacy group.

For private transactions sent to a privacy group, the  corresponding `privacyGroupId` is stored alongside the transaction.

!!! note
    Once created, the members of a privacy group cannot be changed. To add or remove members, a new privacy group must be created.

Privacy groups are currently supported by the [Hyperledger Besu](https://besu.hyperledger.org/en/stable/) blockchain client which maintains a [private state per privacy group](https://besu.hyperledger.org/en/stable/Concepts/Privacy/Privacy-Groups/).

## Legacy Privacy Group

Tessera will automatically create a `legacy` privacy group when a private transaction is sent to a list of recipient public keys using `privateFor`.

When returning private transaction data to a Besu client (as part of a `/receive` response), the `legacy` `privacyGroupId` will also be returned.

The `legacy` `privacyGroupId` is generated by hashing the list of recipient keys. For a given set of recipients, there can be only one `legacy` privacy group.

!!! note
    Besu and Tessera will generate the same `legacy` `privacyGroupId` from the same list of recipients.

An example of a `legacy` privacy group:

```json
{
    "description": "Privacy groups to support the creation of groups by privateFor",
    "members": [
        "98FhPni7u6YspDGcOLl/LgQQwwGPGY4ddm3hmogsqF8=",
        "dzkrEhkHZ/IjHEaQ6teVTU/kMjiwXTI6Ooljcb56w1M="
    ],
    "name": "legacy",
    "privacyGroupId": "jufzisK63xbXDciV0FW1uAi3vXFDNNJpf/M3lUhMiU0=",
    "type": "LEGACY"
}
```

## Pantheon Privacy Group

Tessera supports API methods that enable the creation of `pantheon` privacy groups from a compatible blockchain client (for example Besu).

Upon creation, the privacy group is distributed to all members ahead of transaction processing.

When a private transaction contains a `privacyGroupId`, the transaction payload is distributed to all the members of the privacy group.

The `pantheon` `privacyGroupId` is generated by hashing the list of recipient keys *plus a random seed*. This means that for a given set of recipients, there can be many `pantheon` privacy groups.

## Database Storage

A new table called `PRIVACY_GROUP` is added to Tessera's database to store Privacy Group data.

DDLs are provided along with release notes to create new privacy group tables.

!!! example
    ```sql
    CREATE TABLE PRIVACY_GROUP(ID LONGVARBINARY NOT NULL, LOOKUP_ID LONGVARBINARY NOT NULL, DATA LONGVARBINARY NOT NULL, TIMESTAMP BIGINT, PRIMARY KEY (ID));
    ```

Before being persisted into the database, privacy group data is encoded using `BinaryEncoder` (the same mechanism Tessera uses to encode its `EncodedPayload` data).

## API Versioning

A node running a version of Tessera that does not support privacy groups will not be able to understand requests containing `privacyGroupId`.  This could cause inconsistency of data being persisted on different nodes.

Hence, API version **3.0** has been introduced. Tessera will include the privacy group in the encoded payload in `/push` to only those recipients supporting correct version, else the transaction is failed with `PrivacyGroupNotSupportedException`.

## Privacy Group APIs

Privacy group compatible blockchain clients (for example Besu) can be used to create, delete, find, and retrieve privacy groups. Tessera's `Q2T` API adds support for these operations. Please refer to [API reference](https://consensys.github.io/doc.tessera/) for more details.
